var App,Glue,Gui,LocalStorage,UseCase,__hasProp={}.hasOwnProperty,__bind=function(a,b){return function(){return a.apply(b,arguments)}};_.defaults(this,{Before:function(a,b,c){return YouAreDaBomb(a,b).before(c)},BeforeAnyCallback:function(a,b,c){return YouAreDaBomb(a,b).beforeAnyCallback(c)},After:function(a,b,c){return YouAreDaBomb(a,b).after(c)},Around:function(a,b,c){return YouAreDaBomb(a,b).around(c)},AfterAll:function(a,b,c){var d,e,f,g;g=[];for(e=0,f=b.length;e<f;e++)d=b[e],g.push(After(a,d,c));return g},LogAll:function(a,b){var c,d,e;e=[];for(c in a){if(!__hasProp.call(a,c))continue;d=a[c],_.isFunction(d)?e.push(function(c){return Before(a,c,function(){return console.log("calling: "+b+"::"+c)})}(c)):e.push(void 0)}return e},AutoBind:function(a,b){var c,d,e;e=[];for(c in a)d=a[c],_.isFunction(d)?e.push(function(c){if(c.endsWith("Clicked")&&b[c.remove("Clicked")])return After(a,c,function(a){return b[c.remove("Clicked")](a)})}(c)):e.push(void 0);return e}}),UseCase=function(){function a(){this.codeChanged=__bind(this.codeChanged,this),this.initCodeView=__bind(this.initCodeView,this),this.start=__bind(this.start,this)}return a.prototype.start=function(){return this.initCodeView()},a.prototype.initCodeView=function(){},a.prototype.codeChanged=function(a){},a}(),Glue=function(){function a(a,b,c){var d=this;this.useCase=a,this.gui=b,this.storage=c,AutoBind(this.gui,this.useCase),LogAll(this.useCase,"UseCase"),LogAll(this.gui,"Gui"),LogAll(this.storage,"Storage"),After(this.useCase,"start",this.gui.start),After(this.useCase,"initCodeView",function(){return d.gui.initCodeView(d.storage.getCode())}),After(this.gui,"codeChanged",function(a){return d.useCase.codeChanged(a)}),After(this.useCase,"codeChanged",function(a){return d.storage.setCode(a)})}return a}(),LocalStorage=function(){function a(a){this.namespace=a,this.getCode=__bind(this.getCode,this),this.setCode=__bind(this.setCode,this),this.flush=__bind(this.flush,this),this.remove=__bind(this.remove,this),this.get=__bind(this.get,this),this.set=__bind(this.set,this)}return a.prototype.set=function(a,b){return $.jStorage.set(""+this.namespace+"/"+a,b)},a.prototype.get=function(a){return $.jStorage.get(""+this.namespace+"/"+a)},a.prototype.remove=function(a){return $.jStorage.deleteKey(""+this.namespace+"/"+a)},a.prototype.flush=function(){var a,b,c,d,e;d=$.jStorage.index(),e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.match("^"+this.namespace)?e.push($.jStorage.deleteKey(a)):e.push(void 0);return e},a.prototype.setCode=function(a){return this.set("code",a)},a.prototype.getCode=function(){return this.get("code")||'#include<iostream>\nusing namespace std;\n\nint main() {\n    cout << "Hello World!" << endl;\n    return 0;\n}'},a}(),App=function(){function a(){var a,b,c,d;d=new UseCase,b=new Gui,c=new LocalStorage("webcontest"),a=new Glue(d,b,c),d.start()}return a}(),$(function(){return new App}),Gui=function(){function a(){this.codeChanged=__bind(this.codeChanged,this),this.saveCodeCallback=__bind(this.saveCodeCallback,this),this.setCodeViewFullscreen=__bind(this.setCodeViewFullscreen,this),this.isCodeViewFullScreen=__bind(this.isCodeViewFullScreen,this),this.initCodeView=__bind(this.initCodeView,this),this.start=__bind(this.start,this),this.saveCodeEvery=15}return a.prototype.start=function(){},a.prototype.initCodeView=function(a){var b,c,d=this;return c={mode:"text/x-c++src",theme:"monokai",lineNumbers:!0,indentUnit:4,extraKeys:{F11:function(a){return d.setCodeViewFullScreen(a,!d.isCodeViewFullScreen(a))},Esc:function(a){if(d.isCodeViewFullScreen(a))return d.setCodeViewFullScreen(a,!1)}}},b=document.getElementById("code"),this.cm=CodeMirror.fromTextArea(b,c),this.cm.setValue(a),this.cm.markClean(),setTimeout(this.saveCodeCallback,this.saveCodeEvery*1e3)},a.prototype.isCodeViewFullScreen=function(a){return/\bCodeMirror-fullscreen\b/.test(a.getWrapperElement().className)},a.prototype.setCodeViewFullscreen=function(a,b){var c,d;return d=a.getWrapperElement(),c=window.innerHeight||(document.documentElement||document.body).clientHeight,b?(d.className+=" CodeMirror-fullscreen",d.style.height=c+"px",document.documentElement.style.overflow="hidden"):(d.className=d.className.replace(" CodeMirror-fullscreen",""),d.style.height="",document.documentElement.style.overflow=""),a.refresh},a.prototype.saveCodeCallback=function(){return this.cm.isClean()||this.codeChanged(this.cm.getValue()),this.cm.markClean(),setTimeout(this.saveCodeCallback,this.saveCodeEvery*1e3)},a.prototype.codeChanged=function(a){},a}()